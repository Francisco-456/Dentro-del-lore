<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historia Interactiva de Hollow Knight</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cinzel', Georgia, serif;
            background-color: #0d0d1a;
            color: #d9d9e6;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        h1, h2 {
            color: #e6b800;
            text-shadow: 0 0 5px rgba(230, 184, 0, 0.5);
            text-align: center;
        }
        .section {
            display: none;
            margin-bottom: 20px;
            padding: 25px;
            border: 2px solid #2a2a3e;
            background-color: rgba(26, 26, 46, 0.95);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            background-repeat: repeat;
            background-size: 150px 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            transition: opacity 0.5s;
        }
        .section.active {
            display: flex;
            opacity: 1;
        }
        #intro {
            display: flex;
            opacity: 1;
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"%3E%3Crect fill="%231a1a2e" width="50" height="50"/%3E%3Crect fill="%236a9bd1" x="10" y="10" width="30" height="30" opacity="0.7"/%3E%3C/svg%3E');
        }
        #section1 {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"%3E%3Crect fill="%231a1a2e" width="50" height="50"/%3E%3Cpath fill="%234d7ca6" d="M0 25 h50 M25 0 v50"/%3E%3Ccircle fill="%234d7ca6" cx="25" cy="25" r="5"/%3E%3C/svg%3E');
        }
        #section2 {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"%3E%3Crect fill="%231a1a2e" width="50" height="50"/%3E%3Cpath fill="%235c5c7a" d="M15 15 l20 20 M35 15 l-20 20"/%3E%3Ccircle fill="%231a1a2e" cx="25" cy="25" r="10"/%3E%3C/svg%3E');
        }
        #section3 {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"%3E%3Crect fill="%231a1a2e" width="50" height="50"/%3E%3Cpath fill="%2366bb6a" d="M10 40 q15 -10 30 0"/%3E%3C/svg%3E');
        }
        #section4 {
            background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50"%3E%3Crect fill="%231a1a2e" width="50" height="50"/%3E%3Cpath fill="%23c2185b" d="M0 25 h50 M25 0 v50 M15 15 l20 20 M35 15 l-20 20"/%3E%3C/svg%3E');
        }
        .section-image {
            margin: 15px 0;
            text-align: center;
        }
        .section-image img {
            width: 100%;
            max-width: 300px;
            height: auto;
            border: 2px solid #4d7ca6;
            border-radius: 8px;
            loading: lazy;
        }
        button {
            background-color: #2e4d6d;
            color: #d9d9e6;
            padding: 12px 24px;
            border: 2px solid #4d7ca6;
            cursor: pointer;
            margin: 5px;
            border-radius: 8px;
            font-family: 'Cinzel', Georgia, serif;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.1s;
            touch-action: manipulation;
        }
        button:hover {
            background-color: #3e6d9d;
            transform: scale(1.05);
        }
        button:disabled {
            background-color: #33334d;
            border-color: #55556d;
            cursor: not-allowed;
        }
        .game {
            margin-top: 20px;
            text-align: center;
        }
        .feedback {
            margin-top: 10px;
            font-weight: 700;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.7);
        }
        .correct { color: #4CAF50; }
        .incorrect { color: #ff4500; }
        .memory-game {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            max-width: 300px;
            margin: 0 auto;
        }
        .memory-card {
            width: 60px;
            height: 60px;
            background-color: #2a2a3e;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid #4d7ca6;
            border-radius: 8px;
            transition: background-color 0.3s;
            touch-action: manipulation;
        }
        .memory-card.flipped {
            background-color: #e6b800;
            border-color: #ffd700;
        }
        .combat-game {
            position: relative;
            height: 250px;
            border: 3px solid #4d7ca6;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            background: linear-gradient(180deg, rgba(26, 26, 46, 0.9), rgba(13, 13, 26, 0.9));
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.7);
            margin: 0 auto;
            max-width: 600px;
        }
        .combat-status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        .health-bar {
            width: 120px;
            height: 20px;
            background-color: #1a1a2e;
            border: 2px solid #4d7ca6;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }
        .health-fill {
            height: 100%;
            transition: width 0.5s ease-in-out;
        }
        .player-health .health-fill {
            background-color: #2e4d6d;
        }
        .enemy-health .health-fill {
            background-color: #9b1d64;
        }
        .combat-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        .combat-feedback {
            margin-top: 15px;
            font-style: italic;
            color: #b0b0cc;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.7);
            transition: opacity 0.3s;
        }
        .audio-toggle {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 10;
        }
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            p {
                font-size: 14px;
            }
            .section {
                padding: 15px;
            }
            .section-image img {
                max-width: 200px;
            }
            .combat-game {
                height: 200px;
            }
            .combat-buttons {
                gap: 10px;
            }
        }
        @media (max-width: 400px) {
            .health-bar {
                width: 100px;
            }
        }
        @media (max-height: 600px) {
            .combat-game {
                height: 200px;
            }
        }
        @media (min-width: 1024px) {
            .section {
                padding: 30px;
            }
            button {
                padding: 14px 28px;
                font-size: 18px;
            }
            .health-bar {
                width: 150px;
            }
            .combat-game {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <h1>Historia Interactiva de Hollow Knight</h1>
    <p style="text-align: center;">Bienvenido a esta p√°gina interactiva que cuenta la historia de Hollow Knight. Avanza en la narrativa completando minijuegos variados, como quizzes, juegos de memoria y un combate. ¬°Disfruta!</p>
    <button class="audio-toggle" onclick="toggleAudio()">üîä Audio: ON</button>
    <audio id="section-audio" preload="none"></audio>

    <div id="intro" class="section active">
        <h2>Introducci√≥n: La Tierra Antes de Hallownest</h2>
        <div class="section-image">
            <img src="images/hollow1.jpg" alt="Ruinas antiguas de Hallownest" loading="lazy">
        </div>
        <p>Los registros m√°s antiguos describen una antigua civilizaci√≥n que adoraba el Vac√≠o (Void), una poderosa sustancia negra. Esta civilizaci√≥n desapareci√≥, dejando estatuas, t√≥tems y reliquias. Otro poder, la Radiancia (Radiance), una criatura de luz y sue√±os, cre√≥ a los Moths, que la adoraban como una divinidad. La Radiancia gobern√≥ sin oposici√≥n hasta la llegada del Pale King, un Wyrm masivo con habilidades precognitivas. Al deshacerse de su forma, el Pale King se convirti√≥ en el monarca de Hallownest, otorgando sapiencia, lenguaje y prop√≥sito a los bugs previamente sin mente. Incluso la tribu de los Moths abandon√≥ la Radiancia para adorar al Pale King.</p>
        <button onclick="showSection('section1')">Comenzar la Aventura</button>
    </div>

    <div id="section1" class="section">
        <h2>Secci√≥n 1: Hallownest, el Reino en las Profundidades</h2>
        <div class="section-image">
            <img src="images/hollow2.jpg" alt="Ciudad de las L√°grimas" loading="lazy">
        </div>
        <p>El Pale King, junto a su reina, la Pale Lady, fund√≥ Hallownest, un reino bajo tierra, que se expandi√≥ a trav√©s de concordatos y conquistas. Hallownest vivi√≥ una era dorada, pero esto termin√≥ cuando la Radiancia, olvidada por sus seguidores, busc√≥ recuperar su influencia. Se extendi√≥ a trav√©s de los sue√±os, causando locura y muerte entre los bugs de Hallownest, manifest√°ndose como la Infecci√≥n (Infection), una sustancia naranja que afectaba a los muertos y enloquecidos habitantes. Para combatir esto, el Pale King recurri√≥ a rituales eldritch y al Vac√≠o del Abismo.</p>
        <div class="game">
            <h3>Minijuego: Memoria de Hallownest</h3>
            <p>Encuentra las dos cartas que coincidan con el s√≠mbolo del Vac√≠o (‚ö´).</p>
            <div id="memory-game1" class="memory-game">
                <div class="memory-card" data-value="‚ö´" onclick="flipCard(this, 'section2')">‚ö´</div>
                <div class="memory-card" data-value="‚ö™" onclick="flipCard(this, 'section2')">‚ö™</div>
                <div class="memory-card" data-value="‚ö´" onclick="flipCard(this, 'section2')">‚ö´</div>
                <div class="memory-card" data-value="üî∂" onclick="flipCard(this, 'section2')">üî∂</div>
            </div>
            <div id="feedback1" class="feedback"></div>
        </div>
    </div>

    <div id="section2" class="section">
        <h2>Secci√≥n 2: El Vessel y el Hollow Knight</h2>
        <div class="section-image">
            <img src="images/hollow3.jpg" alt="Abismo y Vessels" loading="lazy">
        </div>
        <p>Para contener a la Radiancia, que exist√≠a en los sue√±os y no pod√≠a ser asesinada, el Pale King y la Pale Lady crearon Vessels, seres nacidos de su uni√≥n y te√±idos por el Vac√≠o. Estos Vessels estaban destinados a ser caparazones vac√≠os sin alma, lo suficientemente fuertes para aprisionar a la Radiancia. El Hollow Knight original, uno de estos Vessels, inicialmente tuvo √©xito en contener a la Radiancia. Sin embargo, no era puro, y la Infecci√≥n se extendi√≥ de nuevo, llevando a la decadencia de Hallownest. El Pale King desapareci√≥, y sus adoradores se convirtieron en cad√°veres reanimados, con la Radiancia a punto de liberarse.</p>
        <div class="game">
            <h3>Minijuego: Quiz del Vessel</h3>
            <p>Pregunta: ¬øQui√©n fund√≥ Hallownest junto al Pale King?</p>
            <button onclick="checkAnswer('Pale Lady', 'section3')">Pale Lady</button>
            <button onclick="checkAnswer('Hornet', 'section3')">Hornet</button>
            <button onclick="checkAnswer('Radiancia', 'section3')">Radiancia</button>
            <div id="feedback2" class="feedback"></div>
        </div>
    </div>

    <div id="section3" class="section">
        <h2>Secci√≥n 3: El Regreso del Knight a Hallownest</h2>
        <div class="section-image">
            <img src="images/hollow4.jpg" alt="Greenpath y Hornet" loading="lazy">
        </div>
        <p>El protagonista, conocido como el Knight, es uno de muchos Vessels descartados creados por el Pale King, considerado un fracaso y dejado en la oscuridad con sus hermanos. Varios Vessels escaparon, y el Knight, guiado por el destino o otra fuerza, regres√≥ al reino roto de Hallownest, ahora festering con la Infecci√≥n. El Knight recorre los pasos del Pale King y el Hollow Knight, reuniendo poder para enfrentar al ser divino dentro de la prisi√≥n del Hollow Knight.</p>
        <div class="game">
            <h3>Minijuego: Combate contra Hornet</h3>
            <p>Derrota a Hornet atacando y esquivando en el momento justo. ¬°Cuidado, solo tienes 3 m√°scaras!</p>
            <div id="combat-game3" class="combat-game">
                <div class="combat-status">
                    <div class="player-health">
                        <p>‚öîÔ∏è Knight: <span id="player-health">3</span></p>
                        <div class="health-bar"><div id="player-health-fill" class="health-fill" style="width: 100%"></div></div>
                    </div>
                    <div class="enemy-health">
                        <p>ü™° Hornet: <span id="enemy-health">5</span></p>
                        <div class="health-bar"><div id="enemy-health-fill" class="health-fill" style="width: 100%"></div></div>
                    </div>
                </div>
                <div class="combat-buttons">
                    <button id="attack-btn" onclick="combatAction('attack')">Atacar</button>
                    <button id="dodge-btn" onclick="combatAction('dodge')">Esquivar</button>
                </div>
                <div id="combat-feedback" class="combat-feedback"></div>
            </div>
            <button onclick="resetCombatGame()">Reiniciar Combate</button>
            <div id="feedback3" class="feedback"></div>
        </div>
    </div>

    <div id="section4" class="section">
        <h2>Secci√≥n 4: Hornet, la Princesa Protectora</h2>
        <div class="section-image">
            <img src="images/hollow5.jpg" alt="Deepnest y Hornet" loading="lazy">
        </div>
        <p>Hornet, encontrada por primera vez en Greenpath, desaf√≠a al Knight en un duelo, posiblemente confundi√©ndolo con otro Vessel loco. Es hija del Pale King, nacida de Herrah the Beast, reina de las ara√±as, como parte de un acuerdo para ayudar a sellar la Radiancia. Herrah, en un sue√±o m√°gico, dej√≥ poco tiempo con Hornet. Criada en Deepnest, un √°rea peligrosa, Hornet es una guerrera h√°bil con el deber de proteger el mundo. Sintiendo el despertar de la Radiancia, ayuda al Knight, actuando como desafiante y gu√≠a en su b√∫squeda para salvar Hallownest.</p>
        <p>¬°Has completado la historia! Explora m√°s sobre Hollow Knight en el juego original.</p>
    </div>

    <script>
        const freesoundKey = 'bxZRT9xeEewoQpBT28lMqOoKHxQkcJdVHk7dA1Pi'; // <--- AQU√ç VA TU CLAVE API
        let audioEnabled = true;
        const sectionSounds = {
            'intro': ['cave', 'ambient cave'],
            'section1': ['rain loop', 'rain'],
            'section2': ['echo', 'cave echo'],
            'section3': ['sword'],
            'section4': ['insect', 'ambient insect']
        };

        async function loadSectionSound(sectionId) {
            if (!audioEnabled) return;
            const queries = Array.isArray(sectionSounds[sectionId]) ? sectionSounds[sectionId] : [sectionSounds[sectionId]];
            const isAmbient = sectionId !== 'section3'; // Secci√≥n 3 usa efectos, no loop
            let soundUrl = null;

            for (const query of queries) {
                try {
                    const response = await fetch(`https://freesound.org/apiv2/search/text/?query=${encodeURIComponent(query)}&token=${freesoundKey}&fields=id,previews`);
                    if (!response.ok) {
                        if (response.status === 401) {
                            console.error(`Error 401: Clave API inv√°lida para "${query}". Obt√©n una nueva clave en https://freesound.org/apiv2/apply/`);
                        } else {
                            console.error(`Error HTTP ${response.status} al buscar "${query}"`);
                        }
                        continue;
                    }
                    const data = await response.json();
                    soundUrl = data.results[0]?.previews?.['preview-hq-mp3'] || data.results[0]?.previews?.['preview-lq-mp3'];
                    if (soundUrl) break;
                    console.warn(`No se encontraron sonidos para "${query}", intentando fallback...`);
                } catch (error) {
                    console.error(`Error fetching sound para "${query}":`, error.message);
                }
            }

            if (soundUrl) {
                const audio = document.getElementById('section-audio');
                audio.src = soundUrl;
                audio.volume = isAmbient ? 0.6 : 0.8; // Volumen: 0.6 ambientes, 0.8 combate
                audio.loop = isAmbient; // Loop solo para ambientes
                audio.load();
                audio.play().catch(e => console.warn('Error playing audio:', e.message));
            } else {
                console.warn(`No se encontraron sonidos v√°lidos para "${sectionId}"`);
            }
        }

        function toggleAudio() {
            audioEnabled = !audioEnabled;
            const audioBtn = document.querySelector('.audio-toggle');
            audioBtn.textContent = `üîä Audio: ${audioEnabled ? 'ON' : 'OFF'}`;
            if (!audioEnabled) {
                document.getElementById('section-audio').pause();
            }
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
                section.classList.remove('active');
            });
            const targetSection = document.getElementById(sectionId);
            targetSection.style.display = 'flex';
            targetSection.classList.add('active');
            if (audioEnabled) {
                loadSectionSound(sectionId);
            }
            if (sectionId === 'section3') {
                setupCombatGame();
            }
        }

        // Quiz game
        function checkAnswer(answer, nextSection) {
            const currentSection = nextSection.replace(/\d+/, function(n) { return parseInt(n) - 1; });
            const feedbackId = 'feedback' + currentSection.match(/\d+/)[0];
            const correctAnswers = {
                'section3': 'Pale Lady'
            };
            const correct = document.getElementById(feedbackId);
            if (answer === correctAnswers[nextSection]) {
                correct.textContent = '¬°Correcto! Avanzando...';
                correct.className = 'feedback correct';
                if (audioEnabled) {
                    loadSectionSound(nextSection);
                }
                setTimeout(() => showSection(nextSection), 1000);
            } else {
                correct.textContent = 'Incorrecto. Intenta de nuevo.';
                correct.className = 'feedback incorrect';
            }
        }

        // Memory game
        let flippedCards = [];
        function flipCard(card, nextSection) {
            if (flippedCards.length < 2 && !card.classList.contains('flipped')) {
                card.classList.add('flipped');
                flippedCards.push(card);
                if (flippedCards.length === 2) {
                    const feedbackId = 'feedback' + nextSection.match(/\d+/)[0];
                    const feedback = document.getElementById(feedbackId);
                    if (flippedCards[0].dataset.value === flippedCards[1].dataset.value) {
                        feedback.textContent = '¬°Coincidencia! Avanzando...';
                        feedback.className = 'feedback correct';
                        if (audioEnabled) {
                            loadSectionSound(nextSection);
                        }
                        setTimeout(() => showSection(nextSection), 1000);
                    } else {
                        feedback.textContent = 'No coinciden. Intenta de nuevo.';
                        feedback.className = 'feedback incorrect';
                        setTimeout(() => {
                            flippedCards.forEach(c => c.classList.remove('flipped'));
                            flippedCards = [];
                        }, 1000);
                    }
                }
            }
        }

        // Combat game
        let playerHealth = 3;
        let enemyHealth = 5;
        let isPlayerTurn = true;
        let gameActive = false;

        function setupCombatGame() {
            playerHealth = 3;
            enemyHealth = 5;
            isPlayerTurn = true;
            gameActive = true;
            const playerHealthDisplay = document.getElementById('player-health');
            const enemyHealthDisplay = document.getElementById('enemy-health');
            const playerHealthFill = document.getElementById('player-health-fill');
            const enemyHealthFill = document.getElementById('enemy-health-fill');
            const combatFeedback = document.getElementById('combat-feedback');
            const feedback = document.getElementById('feedback3');
            const attackBtn = document.getElementById('attack-btn');
            const dodgeBtn = document.getElementById('dodge-btn');

            playerHealthDisplay.textContent = playerHealth;
            enemyHealthDisplay.textContent = enemyHealth;
            playerHealthFill.style.width = '100%';
            enemyHealthFill.style.width = '100%';
            combatFeedback.textContent = '¬°Enfrenta a Hornet! Ataca o esquiva.';
            feedback.textContent = '';
            feedback.className = 'feedback';
            attackBtn.disabled = false;
            dodgeBtn.disabled = false;
            if (audioEnabled) {
                loadSectionSound('section3');
            }
        }

        function combatAction(action) {
            if (!gameActive) return;

            const combatFeedback = document.getElementById('combat-feedback');
            const feedback = document.getElementById('feedback3');
            const attackBtn = document.getElementById('attack-btn');
            const dodgeBtn = document.getElementById('dodge-btn');

            if (isPlayerTurn) {
                attackBtn.disabled = true;
                dodgeBtn.disabled = true;

                if (action === 'attack') {
                    const hitChance = Math.random();
                    if (hitChance > 0.3) {
                        enemyHealth--;
                        document.getElementById('enemy-health').textContent = enemyHealth;
                        document.getElementById('enemy-health-fill').style.width = `${(enemyHealth / 5) * 100}%`;
                        combatFeedback.textContent = '¬°Tu clavo golpea a Hornet!';
                        if (audioEnabled) {
                            loadSectionSound('section3');
                        }
                    } else {
                        combatFeedback.textContent = '¬°Tu ataque falla!';
                    }
                } else {
                    combatFeedback.textContent = '¬°Esquivas la aguja de Hornet!';
                }

                if (enemyHealth <= 0) {
                    gameActive = false;
                    combatFeedback.textContent = '¬°Derrotas a Hornet!';
                    feedback.textContent = '¬°Victoria! Avanzando...';
                    feedback.className = 'feedback correct';
                    if (audioEnabled) {
                        loadSectionSound('section4');
                    }
                    setTimeout(() => showSection('section4'), 1500);
                    return;
                }

                setTimeout(enemyTurn, 1000);
            }
        }

        function enemyTurn() {
            if (!gameActive) return;

            const combatFeedback = document.getElementById('combat-feedback');
            const attackBtn = document.getElementById('attack-btn');
            const dodgeBtn = document.getElementById('dodge-btn');

            const enemyAction = Math.random() > 0.5 ? 'attack' : 'prepare';
            if (enemyAction === 'attack') {
                const dodgeChance = document.getElementById('dodge-btn').disabled ? 0.7 : 0.3;
                if (Math.random() < dodgeChance) {
                    playerHealth--;
                    document.getElementById('player-health').textContent = playerHealth;
                    document.getElementById('player-health-fill').style.width = `${(playerHealth / 3) * 100}%`;
                    combatFeedback.textContent = '¬°Hornet te golpea con su aguja!';
                    if (audioEnabled) {
                        loadSectionSound('section3');
                    }
                } else {
                    combatFeedback.textContent = '¬°Hornet falla su ataque!';
                }
            } else {
                combatFeedback.textContent = 'Hornet se prepara, ajustando su aguja...';
            }

            if (playerHealth <= 0) {
                gameActive = false;
                combatFeedback.textContent = '¬°Tu m√°scara se rompe!';
                feedback.textContent = 'Derrotado. Reinicia el combate.';
                feedback.className = 'feedback incorrect';
                attackBtn.disabled = true;
                dodgeBtn.disabled = true;
                return;
            }

            isPlayerTurn = true;
            attackBtn.disabled = false;
            dodgeBtn.disabled = false;
            combatFeedback.textContent += ' ¬°Tu turno!';
        }

        function resetCombatGame() {
            setupCombatGame();
        }
    </script>
</body>
</html>